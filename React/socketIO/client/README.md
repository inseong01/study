# Socket.IO μ±„ν…μ°½ π“¬

Socket.io-clientλ¥Ό ν™μ©ν•μ—¬ Reactλ΅, μ„λ²„λ” Express κµ¬ν„, λ μ΄μ•„μ›ƒμ€ Bootstrap μ‚¬μ©

## π“· κµ¬ν„ μ¤ν¬λ¦°μƒ·
### μ±„ν…λ°© μ…μ¥
<img src="../../md/img/socket1.png" width="75%">     

### μ„λΈ μ±„ν…λ°© μ…μ¥ μƒνƒ
<img src="../../md/img/socket2.png" width="75%">    
<img src="../../md/img/socket3.png" width="75%">    

### λ©”μ‹μ§€ μ „μ†΅
<img src="../../md/img/socket4.png" width="75%">    

### μ±„ν…λ°© λ‚κ°€κΈ° 
<img src="../../md/img/socket5.png" width="75%">    

### μ±—λ΄‡ - formData κ°€κ³µ 
<img src="../../md/img/socket6.png" width="75%">    


## π“ λ¬Έμ ν•΄κ²°
  - ### μ„λ²„-ν΄λΌμ΄μ–ΈνΈ μ—°κ²°    
    : μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ μ†μΌ“ `connect`λ§ κµ¬ν„ν•κ³  ν™•μΈν•¨. `socket.connected`κ°€ κ³„μ† `false`μ€μ. κ°λ°μ μ°½μ„ ν†µν•΄ μ—°κ²°μ„ ν™•μΈν•΄λ΄„. `'... by CORS'` κ²½κ³  λ– μ„ `cors` μ΄κΈ° μ„¤μ •μΌλ΅ `localhost:3000`, `localhost:5173` νΈμ¤νΈλ¥Ό μ—°κ²°ν•¨. μ—¬κΈ°κΉμ§€ κΈλ°© ν•΄κ²°ν–μ§€λ§ `localhost:3000 /socket.io (not Found) 404` μ—λ¬κ°€ μƒκΉ€. λ¬΄μ—‡μ΄ λ¬Έμ μΈμ§€ λ°λμ. ν„μ¬ κµ¬ν„ν• κ°λ°μμ°½ μ‘μ©ν”„λ΅κ·Έλ¨ μ—°κ²°λ νμΌν•κ³  μ „μ— μ‹¤μµν• μ„λ²„μ™€ μ—°κ²°λ νμΌμ„ λΉ„κµν•΄λ΄„. λ¬Έμ λ” μ—†μ—μ. κµ¬κΈ€λ§μ„ ν•΄λ΄λ„ λ€λ¶€λ¶„ `cros` λ¬Έμ  ν•΄κ²°μ„ μ•λ ¤μ£Όκ³  μμ–΄μ„ ν•΄κ²°ν•κΈ° μ–΄λ ¤μ› μ.     

    λ‹¤μ‹ μ²μ²ν λ΅κ·Έλ¥Ό λ΄„. `localhost:3000` μ—λ¬λ” μ„λ²„μ½ λ¬Έμ μ—¬μ„ μ„λ²„ νμΌμ„ λ‹¤μ‹ λ΄„. μμ„Έν λ³΄λ‹ `app.listen(3000)`κ°€ λ¬Έμ μ€μ.   
    
    
    ```javascript
    const app = express();
    const server = createServer(app);

    app.listen(3000);
    ```

    `app`μ΄ μ•„λ‹ `server` λ³€μλ΅ μ„λ²„λ¥Ό μ—΄μ–΄μ•Ό ν•λ”λ° λ°λ€λ΅ ν•κ³  μμ—μ.    
    
    λ‘μ μ°¨μ΄μ μ€ `app`μ€ `ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ λ΅μ§`μ„ μ²λ¦¬ν•κ³  `server`λ” `app`μ΄ μ²λ¦¬ν• λ‚΄μ©μ„ λ³΄μ—¬μ¤. `server.listen(3000)`μΌλ΅ κ°„λ‹¨ν•κ² μ„λ²„-ν΄λΌμ΄μ–ΈνΈ μ—°κ²° λ¬Έμ  ν•΄κ²°. μ°Έ μ–΄μ΄μ—†λ” μ‹¤μμ€μ.
         
  - ### λ‚΄κ°€ λ³΄λ‚Έ λ©”μ‹μ§€    
    : μ„λ²„λ΅ ν΄λΌμ΄μ–ΈνΈλ¥Ό κµ¬ν„ν•λ©΄ λ‹¤μ¤‘ μ°½μΌλ΅ μ—¬λ¬ λ…μ μ—­ν• μ„ ν•  μ μμ§€λ§ ν΄λΌμ΄μ–ΈνΈμ μ£Όμ†κ°€ μ •ν•΄μ Έ μμ–΄μ„ 1λ…μ μ•„μ΄λ””λ§ μ‚¬μ©κ°€λ¥ν–μ.   

    λ‚΄κ°€ λ³΄λ‚Έ λ©”μ‹μ§€λ¥Ό μ•κΈ° μ„ν•΄ μ„λ²„λ΅ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Ό λ• ν„μ¬ μ‘μ„±ν• μ‚¬λμ `id`λ„ κ°™μ΄ λ³΄λƒ„. λ‹¤μ‹ λλλ ¤λ°›μ„ λ•, `Event.jsx`μ—μ„ ν„μ¬ ν΄λΌμ΄μ–ΈνΈ `socket.id`μ™€ λ©”μ‹μ§€ `id`λ¥Ό λΉ„κµν•¨. κ²°κ³Όμ— λ”°λΌ ν΄λμ¤λ… λ‹¬λ¦¬ λ¶€μ—¬ν•κ³  `css`λ΅ κΎΈλ°  

  - ### μ„λΈ μ±„ν…λ°© μ…μ¥ μƒνƒ   
    : λ‚΄κ°€ λ³΄λ‚Έ λ©”μ‹μ§€λ¥Ό μ•λ ¤λ©΄ `socket.adaptor`μ μ •λ³΄λ¥Ό μ•μ•„μ•Ό ν–μ. ν΄λΌμ΄μ–ΈνΈκ°€ μ•„λ‹ μ„λ²„ `socket`μ΄ ν•„μ”ν–μ. (ν΄λΌμ΄μ–ΈνΈμ—λ” `sids`, `rooms` μ •λ³΄ μ—†μ)     

    μ„λ²„ ν΄λ” `index.js`μ—μ„ `join`, `leave` μ΄λ²¤νΈ λ§μ§€λ§‰μ— μ½”λ“ ν•μ¤„ μ¶”κ°€. 
    ```javascript 
    io.emit(`user`, { id: 'io', sids: sidsArr }); 
    // sids : μ ‘μ†ν• μ•„μ΄λ”” λ©λ΅(ν„μ¬ μ ‘μ†ν• λ°© λ³΄μ—¬μ¤)
    ```   
    λΉ„μ£Όμ–Όμ¤νλ””μ¤ μ½μ†”μ—μ„λ” μ λ‚μ™”μ§€λ§ μ›Ή μ½μ†”μ—μ„λ” λΉ κ°’μ΄ μ¶λ ¥λ¨. μ•κ³ λ³΄λ‹ `set` κ°’μ€ μ „λ‹¬λμ§€ μ•λ” `json` ν•νƒμ€μ. `set`μ„ λ°°μ—΄ ν•νƒλ΅ λ³€ν™ν•μ—¬ μ „λ‹¬.   

    `useContext`λ΅ λ°›μ•„μ¤κ³  ν„μ¬ ν΄λΌμ΄μ–ΈνΈ `socket.id`λ΅ `sids` λ°°μ—΄μ— ν•΄λ‹Ή μ•„μ΄λ””μ λ°© λ°°μ—΄μ„ ν™•μΈμΌλ΅ μƒνƒ κµ¬ν„  

  - ### μ±—λ΄‡ - formData μ „μ†΅
    : μ„λ²„λ” `emit`μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ—κ² λ°μ΄ν„°λ¥Ό μ „μ†΅ν•λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” `onFooEvent` ν•¨μλ΅ μ„λ²„κ°€ λ³΄λ‚Έ λ°μ΄ν„°λ¥Ό λ°›λ”λ‹¤.     
    
    ν΄λΌμ΄μ–ΈνΈκ°€ νΉμ • λ°©μ— μ ‘μ†ν–μ„ λ• μ„λ²„λ” `formData`λ¥Ό μ „μ†΅ν•λ‹¤. ν΄λΌμ΄μ–ΈνΈ λ” `formData`λ¥Ό λ°›μΌλ©΄ `<FormData />` μ»΄ν¬λ„νΈλ¥Ό μƒμ„±ν•λ‹¤. μ…λ ¥λ μƒνƒκ°’μΌλ΅ μ„λ²„λ΅ μ „λ‹¬ν•  μ μλ‹¤.

### μ—λ¬ κΈ°λ΅
  - ### vercel - Websocket κµ¬ν„ μ–΄λ ¤μ›€
  
    [Do Vercel Serverless Functions support WebSocket connections?](https://vercel.com/guides/do-vercel-serverless-functions-support-websocket-connections)